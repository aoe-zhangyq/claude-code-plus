<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claude Code Plus</title>
  <!-- üöÄ ËÆæÁΩÆÁΩëÈ°µÊ†áÈ¢òÔºàÈ°πÁõÆË∑ØÂæÑ+È°πÁõÆÂêçÔºâ -->
  <script>
    (function() {
      try {
        var params = new URLSearchParams(window.location.search);
        var projectPath = params.get('projectPath');
        var projectName = params.get('projectName');
        if (projectPath && projectName) {
          // Ê†áÂáÜÂåñË∑ØÂæÑÂàÜÈöîÁ¨¶
          var normalizedPath = projectPath.replace(/\\/g, '/');

          // ÂéªÈô§Êó†Âå∫ÂàÜÂ∫¶ÁöÑÂ∏∏ËßÅÂ≠óÁ¨¶
          var noisePatterns = [
            /^\/mnt\//i,             // WSL ÁõòÁ¨¶ÂâçÁºÄ
            /^[A-Z]:\//i,            // Windows ÁõòÁ¨¶
            /^\/+/i,                 // ÂºÄÂ§¥ÁöÑÊñúÊù†
            /\/Develop\//i,          // Develop
            /\/Code\//i,             // Code
            /\/SVN\//i,              // SVN
            /\/GitHub\//i,           // GitHub
            /\/Gitee\//i,            // Gitee
            /\/Gitea\//i,            // Gitea
            /\/branches\//i,         // branches
            /\/src\//i,              // src
            /\/bec\//i,              // bec
            /\/be\//i                // be
          ];

          var cleanedPath = normalizedPath;
          noisePatterns.forEach(function(pattern) {
            cleanedPath = cleanedPath.replace(pattern, '/');
          });

          // ÂéªÈô§È¶ñÂ∞æÊñúÊù†Âπ∂ÂàÜÂâ≤
          var pathParts = cleanedPath.replace(/^\/+|\/+$/g, '').split('/').filter(function(p) {
            return p && p.trim().length > 0;
          });

          // ÂèñÊúÄÂêé2-3‰∏™ÊúâÊÑè‰πâÁöÑÈÉ®ÂàÜ
          var meaningfulParts = pathParts.slice(-3);

          // Â¶ÇÊûúÂè™Ââ©‰∏Ä‰∏™ÈÉ®ÂàÜÔºå‰ΩøÁî®È°πÁõÆÂêç
          var displayName = meaningfulParts.length > 0
            ? meaningfulParts.join('/')
            : projectName;

          document.title = displayName + ' - Claude Code Plus';
        }
      } catch (e) {
        console.warn('Failed to set page title:', e);
      }
    })();
  </script>
  <!-- üöÄ Á´ãÂç≥Â∫îÁî®ÂàùÂßã‰∏ªÈ¢òÔºåÈÅøÂÖçÈó™ÁÉÅ -->
  <script>
    (function() {
      try {
        var params = new URLSearchParams(window.location.search);
        var themeParam = params.get('initialTheme');
        if (!themeParam) return;

        var theme = JSON.parse(decodeURIComponent(themeParam));
        var root = document.documentElement;

        // Ê≥®ÂÖ• CSS ÂèòÈáè
        var vars = {
          '--theme-background': theme.background,
          '--theme-foreground': theme.foreground,
          '--theme-panel-background': theme.panelBackground,
          '--theme-border': theme.borderColor,
          '--theme-text-field-background': theme.textFieldBackground,
          '--theme-selection-background': theme.selectionBackground,
          '--theme-selection-foreground': theme.selectionForeground,
          '--theme-link': theme.linkColor,
          '--theme-error': theme.errorColor,
          '--theme-warning': theme.warningColor,
          '--theme-success': theme.successColor,
          '--theme-separator': theme.separatorColor,
          '--theme-hover-background': theme.hoverBackground,
          '--theme-accent': theme.accentColor,
          '--theme-info-background': theme.infoBackground,
          '--theme-code-background': theme.codeBackground,
          '--theme-secondary-foreground': theme.secondaryForeground,
          '--theme-card-background': theme.panelBackground
        };

        if (theme.fontFamily) vars['--theme-font-family'] = theme.fontFamily;
        if (theme.fontSize) vars['--theme-font-size'] = theme.fontSize + 'px';
        if (theme.editorFontFamily) vars['--theme-editor-font-family'] = theme.editorFontFamily;
        if (theme.editorFontSize) vars['--theme-editor-font-size'] = theme.editorFontSize + 'px';

        for (var key in vars) {
          root.style.setProperty(key, vars[key]);
        }

        // ‰øùÂ≠òÂà∞ window ‰æõ themeService ‰ΩøÁî®
        window.__initialTheme = theme;
        console.log('üé® [HTML] Initial theme applied from URL');
      } catch (e) {
        console.warn('üé® [HTML] Failed to apply initial theme:', e);
      }
    })();
  </script>
</head>
<body>
  <div id="app"></div>
  <script type="module" src="/src/main.ts"></script>
</body>
</html>
